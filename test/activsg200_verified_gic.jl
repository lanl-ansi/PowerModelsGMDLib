using PowerModelsGMD
const _PMGMD = PowerModelsGMD

import InfrastructureModels
const _IM = InfrastructureModels

import PowerModels
const _PM = PowerModels

import JSON
import JuMP
import Ipopt
import Juniper
import LinearAlgebra
import SparseArrays
using Test
using GZip
import Memento

Memento.setlevel!(Memento.getlogger(_PMGMD), "error")
Memento.setlevel!(Memento.getlogger(_IM), "error")
Memento.setlevel!(Memento.getlogger(_PM), "error")

_PMGMD.logger_config!("error")
const TESTLOG = Memento.getlogger(_PMGMD)
Memento.setlevel!(TESTLOG, "error")

ipopt_solver = JuMP.optimizer_with_attributes(Ipopt.Optimizer, "tol" => 1e-4, "print_level" => 0, "sb" => "yes")
juniper_solver = JuMP.optimizer_with_attributes(Juniper.Optimizer, "nl_solver" => _PM.optimizer_with_attributes(Ipopt.Optimizer, "tol" => 1e-4, "print_level" => 0, "sb" => "yes"), "log_levels" => [])
setting = Dict{String,Any}("output" => Dict{String,Any}("branch_flows" => true))


# data = "../test/data/matpower/activsg200.m"
# case = _PM.parse_file(data)

data = "../data/verified_cases/200Bus/activsg200.m.gz"
io = GZip.open(data)
case = _PM.parse_matpower(io)
close(io)

raw_file = "../data/verified_cases/200Bus/activsg200.raw.gz" 
gic_file = "../data/verified_cases/200Bus/activsg200.gic.gz" 
csv_file = "../data/verified_cases/200Bus/activsg200_gic_lines.csv.gz" 

raw_io = GZip.open(raw_file)
gic_io = GZip.open(gic_file)
csv_io = GZip.open(csv_file)

raw_data = PowerModels.parse_psse(raw_io)
gic_data = PowerModelsGMD.parse_gic(gic_io)
case = PowerModelsGMD.generate_dc_data(gic_data, raw_data)
PowerModelsGMD.add_coupled_voltages!(csv_io, case)

close(raw_io)
close(gic_io)
close(csv_io)

_PMGMD.add_gmd_3w_branch!(case)

sol= _PMGMD.solve_gmd(case) # linear solver
# sol=  _PMGMD.solve_gmd(case, ipopt_solver; setting=setting) # for opt solver

high_error = 1e-2 # abs(value) >= .0001
low_error = 1 # abs(value) < .0001

@testset "Verified 200-bus solve of GMD" begin
	@testset "dc bus voltage" begin
		@test isapprox(sol["solution"]["gmd_bus"]["1"]["gmd_vdc"], -0.00038335, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["2"]["gmd_vdc"], -0.00042969, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["3"]["gmd_vdc"], 1.582e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["4"]["gmd_vdc"], -1.997e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["5"]["gmd_vdc"], -0.00244804, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["6"]["gmd_vdc"], 0.00014362, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["7"]["gmd_vdc"], -0.91744745, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["8"]["gmd_vdc"], -0.00350741, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["9"]["gmd_vdc"], -0.00015459, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["10"]["gmd_vdc"], 0.00240021, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["11"]["gmd_vdc"], 0.00219002, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["12"]["gmd_vdc"], -1.62e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["13"]["gmd_vdc"], 5.891e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["14"]["gmd_vdc"], -0.00016201, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["15"]["gmd_vdc"], -0.00107522, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["16"]["gmd_vdc"], -0.00063821, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["17"]["gmd_vdc"], 7.94e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["18"]["gmd_vdc"], -0.00032006, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["19"]["gmd_vdc"], 6.227e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["20"]["gmd_vdc"], -3.141e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["21"]["gmd_vdc"], 3.73771811, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["22"]["gmd_vdc"], -0.00072417, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["23"]["gmd_vdc"], 0.54608577, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["24"]["gmd_vdc"], -0.0001252, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["25"]["gmd_vdc"], 2.98244643, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["26"]["gmd_vdc"], -0.00197493, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["27"]["gmd_vdc"], -1.15e-06, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["28"]["gmd_vdc"], -2.754e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["29"]["gmd_vdc"], -4.07e-06, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["30"]["gmd_vdc"], -4.92e-06, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["31"]["gmd_vdc"], -1.198e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["32"]["gmd_vdc"], -8.091e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["33"]["gmd_vdc"], 4.50473213, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["34"]["gmd_vdc"], -4.19008255, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["35"]["gmd_vdc"], -2.644e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["36"]["gmd_vdc"], -3.65473819, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["37"]["gmd_vdc"], -0.00023495, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["38"]["gmd_vdc"], 1.44499445, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["39"]["gmd_vdc"], -1.92e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["40"]["gmd_vdc"], 3.887e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["41"]["gmd_vdc"], -2.175e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["42"]["gmd_vdc"], -8.4e-06, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["43"]["gmd_vdc"], -15.05074883, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["44"]["gmd_vdc"], -3.43058801, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["45"]["gmd_vdc"], 5.9466691, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["46"]["gmd_vdc"], -0.00013385, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["47"]["gmd_vdc"], 2.059e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["48"]["gmd_vdc"], -0.00010929, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["49"]["gmd_vdc"], -4.78124809, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["50"]["gmd_vdc"], 0.00212545, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["51"]["gmd_vdc"], -0.00016913, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["52"]["gmd_vdc"], 2.84264874, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["53"]["gmd_vdc"], 0.00017216, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["54"]["gmd_vdc"], 1.094e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["55"]["gmd_vdc"], -0.00043891, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["56"]["gmd_vdc"], -0.00100942, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["57"]["gmd_vdc"], -2.425e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["58"]["gmd_vdc"], 0.00014033, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["59"]["gmd_vdc"], -1.40395248, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["60"]["gmd_vdc"], -2.07247853, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["61"]["gmd_vdc"], -0.00031819, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["62"]["gmd_vdc"], -4.07e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["63"]["gmd_vdc"], -0.00024564, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["64"]["gmd_vdc"], -2.97019434, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["65"]["gmd_vdc"], -4.06109142, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["66"]["gmd_vdc"], 1.24523878, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["67"]["gmd_vdc"], 0.0001572, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["68"]["gmd_vdc"], -0.00013163, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["69"]["gmd_vdc"], 2.55e-06, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["70"]["gmd_vdc"], -8.71586514, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["71"]["gmd_vdc"], -0.00013669, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["72"]["gmd_vdc"], 8.531e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["73"]["gmd_vdc"], -0.0001826, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["74"]["gmd_vdc"], 5.394e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["75"]["gmd_vdc"], -2.067e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["76"]["gmd_vdc"], -1.831e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["77"]["gmd_vdc"], 0.00015058, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["78"]["gmd_vdc"], -2.054e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["79"]["gmd_vdc"], -0.00053575, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["80"]["gmd_vdc"], -15.89966679, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["81"]["gmd_vdc"], 0.00015061, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["82"]["gmd_vdc"], -9.33065987, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["83"]["gmd_vdc"], -2.71218681, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["84"]["gmd_vdc"], -3.692e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["85"]["gmd_vdc"], -6.059e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["86"]["gmd_vdc"], -4.77413368, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["87"]["gmd_vdc"], 9.969e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["88"]["gmd_vdc"], 9.21918011, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["89"]["gmd_vdc"], -0.00017627, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["90"]["gmd_vdc"], 0.0002242, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["91"]["gmd_vdc"], 0.00012665, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["92"]["gmd_vdc"], 0.00102077, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["93"]["gmd_vdc"], 0.00013173, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["94"]["gmd_vdc"], -0.00245528, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["95"]["gmd_vdc"], -2.081e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["96"]["gmd_vdc"], 16.7992363, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["97"]["gmd_vdc"], 0.00011209, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["98"]["gmd_vdc"], -3.62125754, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["99"]["gmd_vdc"], 7.166e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["100"]["gmd_vdc"], -0.00058082, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["101"]["gmd_vdc"], -2.948e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["102"]["gmd_vdc"], -3.70574188, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["103"]["gmd_vdc"], -4.166e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["104"]["gmd_vdc"], 0.00045644, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["105"]["gmd_vdc"], 1.519e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["106"]["gmd_vdc"], -0.00010309, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["107"]["gmd_vdc"], -8.778e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["108"]["gmd_vdc"], 0.60580927, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["109"]["gmd_vdc"], -4.193e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["110"]["gmd_vdc"], 0.00396924, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["111"]["gmd_vdc"], -7.069e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["112"]["gmd_vdc"], -4.49861383, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["113"]["gmd_vdc"], -4.49860859, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["114"]["gmd_vdc"], -10.84522057, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["115"]["gmd_vdc"], -10.84521008, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["116"]["gmd_vdc"], 2.488832, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["117"]["gmd_vdc"], 2.4888289, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["118"]["gmd_vdc"], -1.3866359, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["119"]["gmd_vdc"], -1.38663435, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["120"]["gmd_vdc"], -6.52635336, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["121"]["gmd_vdc"], -6.52634668, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["122"]["gmd_vdc"], 3.62638617, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["123"]["gmd_vdc"], 3.62638259, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["124"]["gmd_vdc"], 3.62638211, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["125"]["gmd_vdc"], -0.18062465, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["126"]["gmd_vdc"], -1.27687013, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["127"]["gmd_vdc"], -1.27686977, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["128"]["gmd_vdc"], -17.83521652, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["129"]["gmd_vdc"], -17.83520126, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["130"]["gmd_vdc"], -17.83520126, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["131"]["gmd_vdc"], -17.83519745, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["132"]["gmd_vdc"], -17.83519745, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["133"]["gmd_vdc"], -5.53569412, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["134"]["gmd_vdc"], -5.53568792, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["135"]["gmd_vdc"], -5.53568745, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["136"]["gmd_vdc"], 23.00612831, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["137"]["gmd_vdc"], 23.00610352, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["138"]["gmd_vdc"], 7.1170063, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["139"]["gmd_vdc"], 7.11699867, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["140"]["gmd_vdc"], -1.78770936, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["141"]["gmd_vdc"], -1.78770709, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["142"]["gmd_vdc"], 0.73229289, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["143"]["gmd_vdc"], 0.73229206, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["144"]["gmd_vdc"], 0.73229223, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["145"]["gmd_vdc"], -7.51812363, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["146"]["gmd_vdc"], -7.518116, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["147"]["gmd_vdc"], -10.73323727, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["148"]["gmd_vdc"], -10.73322678, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["149"]["gmd_vdc"], -10.73322487, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["150"]["gmd_vdc"], -15.49197388, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["151"]["gmd_vdc"], -15.49195957, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["152"]["gmd_vdc"], 14.90454006, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["153"]["gmd_vdc"], -10.2237978, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["154"]["gmd_vdc"], 6.94479656, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["155"]["gmd_vdc"], -30.23489571, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["156"]["gmd_vdc"], 4.81281519, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["157"]["gmd_vdc"], 4.29150248, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["158"]["gmd_vdc"], -8.68870163, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["159"]["gmd_vdc"], 0.72702789, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["160"]["gmd_vdc"], 0.54608577, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["161"]["gmd_vdc"], 0.54608577, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["162"]["gmd_vdc"], 0.54608577, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["163"]["gmd_vdc"], 0.54608577, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["164"]["gmd_vdc"], 0.54608577, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["165"]["gmd_vdc"], -9.40817451, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["166"]["gmd_vdc"], 7.46221161, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["167"]["gmd_vdc"], 6.95648432, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["168"]["gmd_vdc"], -4.242486, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["169"]["gmd_vdc"], -0.17857276, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["170"]["gmd_vdc"], -3.65038824, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["171"]["gmd_vdc"], -8.06392288, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["172"]["gmd_vdc"], -1.3050983, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["173"]["gmd_vdc"], -1.62395358, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["174"]["gmd_vdc"], -7.77426434, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["175"]["gmd_vdc"], 5.99116039, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["176"]["gmd_vdc"], 4.50473213, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["177"]["gmd_vdc"], -4.32405663, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["178"]["gmd_vdc"], -4.19008255, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["179"]["gmd_vdc"], -4.19008255, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["180"]["gmd_vdc"], -4.19008255, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["181"]["gmd_vdc"], -4.19008255, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["182"]["gmd_vdc"], -4.19008255, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["183"]["gmd_vdc"], -4.19008255, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["184"]["gmd_vdc"], -4.19008255, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["185"]["gmd_vdc"], -6.99832535, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["186"]["gmd_vdc"], -5.89647579, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["187"]["gmd_vdc"], -3.65473819, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["188"]["gmd_vdc"], -3.65473819, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["189"]["gmd_vdc"], -3.65473819, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["190"]["gmd_vdc"], -3.65473819, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["191"]["gmd_vdc"], -13.42639637, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["192"]["gmd_vdc"], 5.94141722, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["193"]["gmd_vdc"], 3.06791472, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["194"]["gmd_vdc"], -6.47550631, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["195"]["gmd_vdc"], 9.87188053, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["196"]["gmd_vdc"], -27.86432076, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["197"]["gmd_vdc"], -0.47087705, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["198"]["gmd_vdc"], -15.64640427, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["199"]["gmd_vdc"], -15.30696297, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["200"]["gmd_vdc"], -5.08353567, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["201"]["gmd_vdc"], -3.43058801, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["202"]["gmd_vdc"], -3.43058801, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["203"]["gmd_vdc"], -3.43058801, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["204"]["gmd_vdc"], 14.04657364, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["205"]["gmd_vdc"], 5.9466691, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["206"]["gmd_vdc"], -10.78509331, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["207"]["gmd_vdc"], 10.55762386, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["208"]["gmd_vdc"], -27.74376678, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["209"]["gmd_vdc"], -5.18367338, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["210"]["gmd_vdc"], -5.187603, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["211"]["gmd_vdc"], 14.52148914, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["212"]["gmd_vdc"], -4.95997429, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["213"]["gmd_vdc"], 3.72418976, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["214"]["gmd_vdc"], 3.85200214, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["215"]["gmd_vdc"], 2.84264874, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["216"]["gmd_vdc"], 2.84264874, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["217"]["gmd_vdc"], 4.55678511, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["218"]["gmd_vdc"], 5.58110619, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["219"]["gmd_vdc"], -17.62033653, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["220"]["gmd_vdc"], -9.95981407, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["221"]["gmd_vdc"], -4.53042126, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["222"]["gmd_vdc"], 10.89848328, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["223"]["gmd_vdc"], -2.46164012, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["224"]["gmd_vdc"], 0.2449422, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["225"]["gmd_vdc"], -1.40395248, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["226"]["gmd_vdc"], -1.40395248, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["227"]["gmd_vdc"], -2.52953553, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["228"]["gmd_vdc"], -2.90283608, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["229"]["gmd_vdc"], -16.67985153, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["230"]["gmd_vdc"], -7.61108589, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["231"]["gmd_vdc"], -32.44390488, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["232"]["gmd_vdc"], -3.47038746, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["233"]["gmd_vdc"], -3.19161725, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["234"]["gmd_vdc"], -4.62116861, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["235"]["gmd_vdc"], -4.92776871, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["236"]["gmd_vdc"], -4.06109142, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["237"]["gmd_vdc"], -4.06109142, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["238"]["gmd_vdc"], -4.06109142, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["239"]["gmd_vdc"], 1.19278777, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["240"]["gmd_vdc"], 1.61868978, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["241"]["gmd_vdc"], 18.29226685, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["242"]["gmd_vdc"], -8.70999622, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["243"]["gmd_vdc"], 0.89899296, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["244"]["gmd_vdc"], -8.99282265, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["245"]["gmd_vdc"], -9.04585457, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["246"]["gmd_vdc"], -8.71586514, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["247"]["gmd_vdc"], -8.71586514, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["248"]["gmd_vdc"], -9.42301369, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["249"]["gmd_vdc"], 2.25957966, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["250"]["gmd_vdc"], -7.22554398, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["251"]["gmd_vdc"], 8.81908226, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["252"]["gmd_vdc"], -3.73242521, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["253"]["gmd_vdc"], -2.13307357, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["254"]["gmd_vdc"], 30.97347641, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["255"]["gmd_vdc"], -0.8164289, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["256"]["gmd_vdc"], -27.94487762, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["257"]["gmd_vdc"], -16.08408165, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["258"]["gmd_vdc"], -15.89966679, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["259"]["gmd_vdc"], 12.19706917, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["260"]["gmd_vdc"], -9.82914734, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["261"]["gmd_vdc"], -9.20613289, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["262"]["gmd_vdc"], -9.33065987, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["263"]["gmd_vdc"], -9.33065987, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["264"]["gmd_vdc"], -9.33065987, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["265"]["gmd_vdc"], -9.33065987, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["266"]["gmd_vdc"], -9.33065987, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["267"]["gmd_vdc"], -4.42287302, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["268"]["gmd_vdc"], -3.10276675, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["269"]["gmd_vdc"], -5.28528786, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["270"]["gmd_vdc"], -5.51869869, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["271"]["gmd_vdc"], -4.99704885, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["272"]["gmd_vdc"], -4.77413368, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["273"]["gmd_vdc"], 8.8538599, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["274"]["gmd_vdc"], 10.26072121, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["275"]["gmd_vdc"], 9.21918011, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["276"]["gmd_vdc"], 9.21918011, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["277"]["gmd_vdc"], 9.21918011, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["278"]["gmd_vdc"], 9.21918011, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["279"]["gmd_vdc"], 9.21918011, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["280"]["gmd_vdc"], 9.21918011, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["281"]["gmd_vdc"], 9.21918011, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["282"]["gmd_vdc"], -16.60688019, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["283"]["gmd_vdc"], 33.06455612, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["284"]["gmd_vdc"], 16.03970146, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["285"]["gmd_vdc"], 5.32272434, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["286"]["gmd_vdc"], 23.2712822, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["287"]["gmd_vdc"], -19.31587219, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["288"]["gmd_vdc"], -6.89282417, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["289"]["gmd_vdc"], 19.5370388, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["290"]["gmd_vdc"], 18.50569534, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["291"]["gmd_vdc"], 25.26343155, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["292"]["gmd_vdc"], -6.35538769, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["293"]["gmd_vdc"], -3.62125754, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["294"]["gmd_vdc"], -3.62125754, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["295"]["gmd_vdc"], 10.4335947, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["296"]["gmd_vdc"], -15.21825695, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["297"]["gmd_vdc"], -6.4817028, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["298"]["gmd_vdc"], -3.84731245, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["299"]["gmd_vdc"], -4.06449556, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["300"]["gmd_vdc"], -3.70574188, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["301"]["gmd_vdc"], -12.53932381, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["302"]["gmd_vdc"], 45.75274277, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["303"]["gmd_vdc"], 2.99225783, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["304"]["gmd_vdc"], -5.6210413, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["305"]["gmd_vdc"], -9.55320358, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["306"]["gmd_vdc"], 0.8253988, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["307"]["gmd_vdc"], 0.60580927, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["308"]["gmd_vdc"], 0.60580927, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["309"]["gmd_vdc"], -10.852911, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["310"]["gmd_vdc"], 24.91715431, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["311"]["gmd_vdc"], -35.51470566, rtol=high_error)
	end
end
