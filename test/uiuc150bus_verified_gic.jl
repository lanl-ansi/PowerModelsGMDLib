using PowerModelsGMD
const _PMGMD = PowerModelsGMD

import InfrastructureModels
const _IM = InfrastructureModels

import PowerModels
const _PM = PowerModels

import JSON
import JuMP
import Ipopt
import Juniper
import LinearAlgebra
import SparseArrays
using Test
using GZip
import Memento

Memento.setlevel!(Memento.getlogger(_PMGMD), "error")
Memento.setlevel!(Memento.getlogger(_IM), "error")
Memento.setlevel!(Memento.getlogger(_PM), "error")

_PMGMD.logger_config!("error")
const TESTLOG = Memento.getlogger(_PMGMD)
Memento.setlevel!(TESTLOG, "error")

ipopt_solver = JuMP.optimizer_with_attributes(Ipopt.Optimizer, "tol" => 1e-4, "print_level" => 0, "sb" => "yes")
juniper_solver = JuMP.optimizer_with_attributes(Juniper.Optimizer, "nl_solver" => _PM.optimizer_with_attributes(Ipopt.Optimizer, "tol" => 1e-4, "print_level" => 0, "sb" => "yes"), "log_levels" => [])
setting = Dict{String,Any}("output" => Dict{String,Any}("branch_flows" => true))

raw_file = "../data/verified_cases/150Bus/uiuc150bus.raw.gz" 
gic_file = "../data/verified_cases/150Bus/uiuc150bus.gic.gz" 
csv_file = "../data/verified_cases/150Bus/uiuc150bus_gic_lines.csv.gz" 

raw_io = GZip.open(raw_file)
gic_io = GZip.open(gic_file)
csv_io = GZip.open(csv_file)

raw_data = PowerModels.parse_psse(raw_io)
gic_data = PowerModelsGMD.parse_gic(gic_io)
case = PowerModelsGMD.generate_dc_data(gic_data, raw_data)
PowerModelsGMD.load_voltages!(csv_io, case)

close(raw_io)
close(gic_io)
close(csv_io)

_PMGMD.add_gmd_3w_branch!(case)

sol= _PMGMD.solve_gmd(case) # linear solver
# sol=  _PMGMD.solve_gmd(case, ipopt_solver; setting=setting) # for opt solver

high_error = 1e-2 # abs(value) >= .0001

low_error = 1 # abs(value) < .0001

@testset "Verified UIUC 150-bus solve of GMD" begin
	@testset "dc bus voltage" begin
		@test isapprox(sol["solution"]["gmd_bus"]["1"]["gmd_vdc"], 0.00022622, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["2"]["gmd_vdc"], 0.00065024, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["3"]["gmd_vdc"], 0.00012194, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["4"]["gmd_vdc"], 0.00011368, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["5"]["gmd_vdc"], 9.566e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["6"]["gmd_vdc"], 1.824e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["7"]["gmd_vdc"], -2.35334492, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["8"]["gmd_vdc"], -6.024e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["9"]["gmd_vdc"], 0.00021886, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["10"]["gmd_vdc"], -4.37385035, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["11"]["gmd_vdc"], -7.955e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["12"]["gmd_vdc"], 9.479e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["13"]["gmd_vdc"], 0.78162593, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["14"]["gmd_vdc"], 0.00014952, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["15"]["gmd_vdc"], 9.75e-06, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["16"]["gmd_vdc"], 6.116e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["17"]["gmd_vdc"], 0.00021291, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["18"]["gmd_vdc"], 8.05e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["19"]["gmd_vdc"], -0.00023839, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["20"]["gmd_vdc"], 7.87e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["21"]["gmd_vdc"], 6.70529366, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["22"]["gmd_vdc"], -2.08441067, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["23"]["gmd_vdc"], -0.00035673, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["24"]["gmd_vdc"], 0.00035798, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["25"]["gmd_vdc"], -4.535e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["26"]["gmd_vdc"], -7.05804253, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["27"]["gmd_vdc"], 0.00011996, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["28"]["gmd_vdc"], 0.0001449, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["29"]["gmd_vdc"], 5.891e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["30"]["gmd_vdc"], -0.00045311, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["31"]["gmd_vdc"], 0.0001456, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["32"]["gmd_vdc"], 2.83091116, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["33"]["gmd_vdc"], 0.00054064, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["34"]["gmd_vdc"], 0.00017589, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["35"]["gmd_vdc"], 0.00131387, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["36"]["gmd_vdc"], 0.00016195, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["37"]["gmd_vdc"], -1.174e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["38"]["gmd_vdc"], -0.0003787, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["39"]["gmd_vdc"], 0.22502033, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["40"]["gmd_vdc"], -3.834e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["41"]["gmd_vdc"], 0.00057859, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["42"]["gmd_vdc"], 17.26951599, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["43"]["gmd_vdc"], 0.00013689, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["44"]["gmd_vdc"], 26.2484169, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["45"]["gmd_vdc"], 0.00014133, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["46"]["gmd_vdc"], 0.00039491, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["47"]["gmd_vdc"], 0.00130266, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["48"]["gmd_vdc"], 4.81147814, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["49"]["gmd_vdc"], -0.00011063, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["50"]["gmd_vdc"], 6.738e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["51"]["gmd_vdc"], 0.00021104, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["52"]["gmd_vdc"], 2.904e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["53"]["gmd_vdc"], 1.25624669, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["54"]["gmd_vdc"], -0.00023006, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["55"]["gmd_vdc"], 6.012e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["56"]["gmd_vdc"], 6e-08, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["57"]["gmd_vdc"], -5.827e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["58"]["gmd_vdc"], -0.00011529, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["59"]["gmd_vdc"], 0.0001208, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["60"]["gmd_vdc"], 0.00049024, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["61"]["gmd_vdc"], 0.00013854, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["62"]["gmd_vdc"], 3.4513824, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["63"]["gmd_vdc"], 2.34663939, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["64"]["gmd_vdc"], -0.00057426, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["65"]["gmd_vdc"], -0.00027211, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["66"]["gmd_vdc"], -0.00054474, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["67"]["gmd_vdc"], -0.00112558, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["68"]["gmd_vdc"], -0.00015851, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["69"]["gmd_vdc"], -6.033e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["70"]["gmd_vdc"], -12.21193886, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["71"]["gmd_vdc"], -0.00011494, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["72"]["gmd_vdc"], -0.00091538, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["73"]["gmd_vdc"], -0.00045957, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["74"]["gmd_vdc"], -0.00076515, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["75"]["gmd_vdc"], -0.00068416, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["76"]["gmd_vdc"], -0.00087777, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["77"]["gmd_vdc"], -0.00059755, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["78"]["gmd_vdc"], -23.86028099, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["79"]["gmd_vdc"], -0.00040494, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["80"]["gmd_vdc"], -0.00057975, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["81"]["gmd_vdc"], -0.00030043, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["82"]["gmd_vdc"], -0.00025837, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["83"]["gmd_vdc"], -0.00037203, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["84"]["gmd_vdc"], -0.00075847, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["85"]["gmd_vdc"], -7.47914076, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["86"]["gmd_vdc"], 9.277e-05, rtol=low_error)
		@test isapprox(sol["solution"]["gmd_bus"]["87"]["gmd_vdc"], 0.00012024, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["88"]["gmd_vdc"], 0.000239, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["89"]["gmd_vdc"], 6.8858695, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["90"]["gmd_vdc"], 0.00101129, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["91"]["gmd_vdc"], 14.07813358, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["92"]["gmd_vdc"], 3.82842588, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["93"]["gmd_vdc"], -16.03377342, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["94"]["gmd_vdc"], -7.68851376, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["95"]["gmd_vdc"], -9.51236916, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["96"]["gmd_vdc"], 7.80237103, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["97"]["gmd_vdc"], 4.48501635, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["98"]["gmd_vdc"], -3.44951081, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["99"]["gmd_vdc"], -16.03377342, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["100"]["gmd_vdc"], 12.02358437, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["101"]["gmd_vdc"], 34.55973053, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["102"]["gmd_vdc"], 6.48086834, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["103"]["gmd_vdc"], 6.04229784, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["104"]["gmd_vdc"], 5.0843358, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["105"]["gmd_vdc"], 0.96922922, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["106"]["gmd_vdc"], -3.15884876, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["107"]["gmd_vdc"], -3.20154548, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["108"]["gmd_vdc"], 11.63235855, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["109"]["gmd_vdc"], -5.87094069, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["110"]["gmd_vdc"], -4.22798061, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["111"]["gmd_vdc"], 5.0378356, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["112"]["gmd_vdc"], 1.049155, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["113"]["gmd_vdc"], 7.94703293, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["114"]["gmd_vdc"], 0.51824772, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["115"]["gmd_vdc"], 3.25040674, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["116"]["gmd_vdc"], 11.31590843, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["117"]["gmd_vdc"], 4.27848768, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["118"]["gmd_vdc"], -12.6705246, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["119"]["gmd_vdc"], 4.18271971, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["120"]["gmd_vdc"], 7.85284567, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["121"]["gmd_vdc"], -2.79786229, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["122"]["gmd_vdc"], -18.960289, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["123"]["gmd_vdc"], 19.02662468, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["124"]["gmd_vdc"], -2.41011405, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["125"]["gmd_vdc"], -9.47386837, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["126"]["gmd_vdc"], 6.37577772, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["127"]["gmd_vdc"], 7.70148706, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["128"]["gmd_vdc"], 3.13126016, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["129"]["gmd_vdc"], -24.08266449, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["130"]["gmd_vdc"], 7.73861361, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["131"]["gmd_vdc"], 3.7998836, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["132"]["gmd_vdc"], 28.73499107, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["133"]["gmd_vdc"], 9.34862041, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["134"]["gmd_vdc"], 69.83151245, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["135"]["gmd_vdc"], 8.60782814, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["136"]["gmd_vdc"], -0.62391299, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["137"]["gmd_vdc"], -20.12789536, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["138"]["gmd_vdc"], 0.30203515, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["139"]["gmd_vdc"], -2.0377996, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["140"]["gmd_vdc"], 30.75182724, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["141"]["gmd_vdc"], 23.18054008, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["142"]["gmd_vdc"], 7.27572107, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["143"]["gmd_vdc"], 35.23275375, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["144"]["gmd_vdc"], 7.51156139, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["145"]["gmd_vdc"], 20.98940849, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["146"]["gmd_vdc"], 69.23603058, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["147"]["gmd_vdc"], 6.45835543, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["148"]["gmd_vdc"], -5.88004208, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["149"]["gmd_vdc"], 3.58146977, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["150"]["gmd_vdc"], 11.21648693, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["151"]["gmd_vdc"], 1.54329669, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["152"]["gmd_vdc"], 1.6862402, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["153"]["gmd_vdc"], -12.22760296, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["154"]["gmd_vdc"], 3.19554877, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["155"]["gmd_vdc"], 0.00339842, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["156"]["gmd_vdc"], -3.09717321, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["157"]["gmd_vdc"], -6.1276536, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["158"]["gmd_vdc"], 6.42024136, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["159"]["gmd_vdc"], 26.05627441, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["160"]["gmd_vdc"], 7.36324024, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["161"]["gmd_vdc"], 4.63272285, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["162"]["gmd_vdc"], 3.14984941, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["163"]["gmd_vdc"], -30.52169418, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["164"]["gmd_vdc"], -14.46244335, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["165"]["gmd_vdc"], -28.95253754, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["166"]["gmd_vdc"], -59.82399368, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["167"]["gmd_vdc"], -8.42492199, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["168"]["gmd_vdc"], -3.20626545, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["169"]["gmd_vdc"], -16.39185524, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["170"]["gmd_vdc"], -6.10879612, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["171"]["gmd_vdc"], -48.65187836, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["172"]["gmd_vdc"], -24.42574883, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["173"]["gmd_vdc"], -40.66750717, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["174"]["gmd_vdc"], -36.36289215, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["175"]["gmd_vdc"], -46.65300369, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["176"]["gmd_vdc"], -31.75943184, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["177"]["gmd_vdc"], -27.9437561, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["178"]["gmd_vdc"], -21.52240562, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["179"]["gmd_vdc"], -30.81354904, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["180"]["gmd_vdc"], -15.96748734, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["181"]["gmd_vdc"], -13.73213863, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["182"]["gmd_vdc"], -19.77335167, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["183"]["gmd_vdc"], -40.31256866, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["184"]["gmd_vdc"], -10.03910828, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["185"]["gmd_vdc"], 4.93048334, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["186"]["gmd_vdc"], 6.39053202, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["187"]["gmd_vdc"], 12.70293045, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["188"]["gmd_vdc"], 9.24276733, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["189"]["gmd_vdc"], 53.74981308, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["190"]["gmd_vdc"], 7.00079966, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["191"]["gmd_vdc"], 0.43670499, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["192"]["gmd_vdc"], 2.60468578, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["193"]["gmd_vdc"], -13.20588684, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["194"]["gmd_vdc"], -4.64772272, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["195"]["gmd_vdc"], 31.28942299, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["196"]["gmd_vdc"], -5.80835676, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["197"]["gmd_vdc"], -32.74415207, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["198"]["gmd_vdc"], 4.02531242, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["199"]["gmd_vdc"], 8.90824032, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["200"]["gmd_vdc"], -4.72043419, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["201"]["gmd_vdc"], 44.44832993, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["202"]["gmd_vdc"], -19.90348625, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["203"]["gmd_vdc"], 13.60712147, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["204"]["gmd_vdc"], -15.47121048, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["205"]["gmd_vdc"], 2.70549178, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["206"]["gmd_vdc"], 4.12057638, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["207"]["gmd_vdc"], 8.38032246, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["208"]["gmd_vdc"], 14.07813358, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["209"]["gmd_vdc"], 14.07813358, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["210"]["gmd_vdc"], 14.07813358, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["211"]["gmd_vdc"], 3.82842588, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["212"]["gmd_vdc"], 3.82842588, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["213"]["gmd_vdc"], 3.82842588, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["214"]["gmd_vdc"], -16.03377342, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["215"]["gmd_vdc"], -16.03377342, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["216"]["gmd_vdc"], -16.03377342, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["217"]["gmd_vdc"], -16.03377342, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["218"]["gmd_vdc"], -7.68851376, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["219"]["gmd_vdc"], -7.68851376, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["220"]["gmd_vdc"], -7.68851376, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["221"]["gmd_vdc"], -7.68851376, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["222"]["gmd_vdc"], -9.51236916, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["223"]["gmd_vdc"], -9.51236916, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["224"]["gmd_vdc"], -9.51236916, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["225"]["gmd_vdc"], -9.51236916, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["226"]["gmd_vdc"], -9.51236916, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["227"]["gmd_vdc"], 7.80237103, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["228"]["gmd_vdc"], 4.48501635, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["229"]["gmd_vdc"], 4.48501635, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["230"]["gmd_vdc"], 4.48501635, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["231"]["gmd_vdc"], 4.48501635, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["232"]["gmd_vdc"], 4.48501635, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["233"]["gmd_vdc"], -3.44951081, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["234"]["gmd_vdc"], -10.56532764, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["235"]["gmd_vdc"], -10.99717808, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["236"]["gmd_vdc"], -8.16165829, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["237"]["gmd_vdc"], -9.18521786, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["238"]["gmd_vdc"], -7.78137064, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["239"]["gmd_vdc"], 15.38491058, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["240"]["gmd_vdc"], 17.06054306, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["241"]["gmd_vdc"], -16.67617416, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["242"]["gmd_vdc"], -18.19368553, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["243"]["gmd_vdc"], 4.98234892, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["244"]["gmd_vdc"], 4.91192102, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["245"]["gmd_vdc"], 9.7860117, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["246"]["gmd_vdc"], 13.30961132, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["247"]["gmd_vdc"], 4.26220179, rtol=high_error)
		@test isapprox(sol["solution"]["gmd_bus"]["248"]["gmd_vdc"], 4.9294982, rtol=high_error)
	end
end
